# üìò Slowly Changing Dimensions (SCD)

**SCD (–º–µ–¥–ª–µ–Ω–Ω–æ –∏–∑–º–µ–Ω—è—é—â–∏–µ—Å—è –∏–∑–º–µ—Ä–µ–Ω–∏—è)** ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω—è—é—â–∏–º–∏—Å—è –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π (dimensions) –≤ **—Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö –¥–∞–Ω–Ω—ã—Ö (Data Warehouse)**.

üìå –ü—Ä–æ–±–ª–µ–º–∞: –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ –≤–∞–∂–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–æ –∏ —Ö—Ä–∞–Ω–∏—Ç—å **–∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π**.

–ù–∞–ø—Ä–∏–º–µ—Ä:

* –ö–ª–∏–µ–Ω—Ç **–ø–µ—Ä–µ–µ—Ö–∞–ª** (–∞–¥—Ä–µ—Å –∏–∑–º–µ–Ω–∏–ª—Å—è).
* –°–æ—Ç—Ä—É–¥–Ω–∏–∫ **—Å–º–µ–Ω–∏–ª –¥–æ–ª–∂–Ω–æ—Å—Ç—å**.
* –¢–æ–≤–∞—Ä **–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω** –∏–ª–∏ –∏–∑–º–µ–Ω–∏–ª –∫–∞—Ç–µ–≥–æ—Ä–∏—é.

‚ùì –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º? –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–ª–∏ –∑–∞—Ç–∏—Ä–∞—Ç—å?

üëâ –ù–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—á–∞—é—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ **SCD**.



**0** ‚Äî –Ω–µ –º–µ–Ω—è–µ–º

**1** ‚Äî –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º

**2** ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É

**3** ‚Äî –Ω–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞

**4** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ

**6** ‚Äî –≥–∏–±—Ä–∏–¥ (1+2+3)





***

## SCD Type 0 ‚Äî "Fix as is" (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

* –î–∞–Ω–Ω—ã–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.
* –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è **–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è**.
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∞—Ç–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è).





***

## SCD Type 1 ‚Äî "Overwrite" (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—å)

* –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞—Ç—Ä–∏–±—É—Ç –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è.
* –ò—Å—Ç–æ—Ä–∏—è **—Ç–µ—Ä—è–µ—Ç—Å—è**, —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

–ü—Ä–∏–º–µ—Ä:

| CustomerID | Name   | City   |
| ---------- | ------ | ------ |
| 1          | –ò–≤–∞–Ω–æ–≤ | –ú–æ—Å–∫–≤–∞ |

–ò–≤–∞–Ω–æ–≤ –ø–µ—Ä–µ–µ—Ö–∞–ª –≤ –ü–∏—Ç–µ—Ä ‚Üí

| CustomerID | Name   | City |
| ---------- | ------ | ---- |
| 1          | –ò–≤–∞–Ω–æ–≤ | –°–ü–±  |

‚úÖ –ü—Ä–æ—Å—Ç–æ –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ.

‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—à–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.





***

## SCD Type 2 ‚Äî "Add new row" (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)

* –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å**.
* –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è **–ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è**.
* –û–±—ã—á–Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–æ–ª–æ–Ω–∫–∏ `valid_from`, `valid_to`, `is_current`.

–ü—Ä–∏–º–µ—Ä:

| CustomerID | Name   | City   | ValidFrom  | ValidTo    | IsCurrent |
| ---------- | ------ | ------ | ---------- | ---------- | --------- |
| 1          | –ò–≤–∞–Ω–æ–≤ | –ú–æ—Å–∫–≤–∞ | 2020-01-01 | 2022-05-01 | 0         |
| 1          | –ò–≤–∞–Ω–æ–≤ | –°–ü–±    | 2022-05-01 | NULL       | 1         |

‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

‚ùå –î–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ç—É—Ç –≤ –æ–±—ä—ë–º–µ.





***

## SCD Type 3 ‚Äî "Add new column" (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏)

* –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—à–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π** (–æ–±—ã—á–Ω–æ 1 –ø—Ä–µ–¥—ã–¥—É—â–µ–µ).
* –î–ª—è —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤–ª—è—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ `previous_city`.

–ü—Ä–∏–º–µ—Ä:

| CustomerID | Name   | City | PrevCity |
| ---------- | ------ | ---- | -------- |
| 1          | –ò–≤–∞–Ω–æ–≤ | –°–ü–±  | –ú–æ—Å–∫–≤–∞   |

‚úÖ –ü—Ä–æ—Å—Ç–æ –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ.

‚ùå –•—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ N –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–±—ã—á–Ω–æ 1‚Äì2), –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –Ω–µ–ª—å–∑—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.





***

## SCD Type 4 ‚Äî "History table" (–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏)

* –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
* –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–∏—à—É—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é **—Ç–∞–±–ª–∏—Ü—É-–∏—Å—Ç–æ—Ä–∏—é**.

–ü—Ä–∏–º–µ—Ä:

**Customer** (—Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ)

| CustomerID | Name   | City |
| ---------- | ------ | ---- |
| 1          | –ò–≤–∞–Ω–æ–≤ | –°–ü–±  |

**Customer\_History** (–∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)

| CustomerID | City   | ValidFrom  | ValidTo    |
| ---------- | ------ | ---------- | ---------- |
| 1          | –ú–æ—Å–∫–≤–∞ | 2020-01-01 | 2022-05-01 |

‚úÖ –£–¥–æ–±–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

‚ùå –£—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.





***

## SCD Type 6 (Hybrid: 1+2+3)

–°–æ—á–µ—Ç–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤:

* —Ö—Ä–∞–Ω–∏–º –∏—Å—Ç–æ—Ä–∏—é (–∫–∞–∫ Type 2),
* —Ö—Ä–∞–Ω–∏–º "—Ç–µ–∫—É—â—É—é" –∏ "–ø—Ä–µ–¥—ã–¥—É—â—É—é" –≤–µ—Ä—Å–∏—é (–∫–∞–∫ Type 3),
* –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∑–∞–ø–∏—Å—å (–∫–∞–∫ Type 1).

–ü—Ä–∏–º–µ—Ä:

| CustomerID | Name   | City | PrevCity | ValidFrom  | ValidTo | IsCurrent |
| ---------- | ------ | ---- | -------- | ---------- | ------- | --------- |
| 1          | –ò–≤–∞–Ω–æ–≤ | –°–ü–±  | –ú–æ—Å–∫–≤–∞   | 2022-05-01 | NULL    | 1         |

‚úÖ –ì–∏–±–∫–æ, –º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

‚ùå –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.





***

## –ö–∞–∫ –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é?

**Type 0** ‚Äî —Å—Ç–∞—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–ª–µ–Ω–¥–∞—Ä—å).

**Type 1** ‚Äî –µ—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–µ –Ω—É–∂–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –∏–º–µ–Ω–∏).

**Type 2** ‚Äî –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ **–ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è** (–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞, –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞).

**Type 3** ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ **—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞–∑–∞–¥** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ "—Å—Ç–∞—Ä—ã–π/–Ω–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ").

**Type 4** ‚Äî –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏–º –æ—Ç–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

**Type 6** ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å –∏ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.





***

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SCD

* –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ **—Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö (DWH, OLAP)**.
* –û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å: –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö "–Ω–∞ –º–æ–º–µ–Ω—Ç X".
* –ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, —Ç–æ–≤–∞—Ä–æ–≤, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.
* –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á—ë—Ç –∏ –∞—É–¥–∏—Ç.



