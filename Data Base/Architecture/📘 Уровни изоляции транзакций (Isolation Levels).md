
–ò–∑–æ–ª—è—Ü–∏—è (Isolation) –≤ [[üìò ACID]] ‚Äî —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—â–µ–µ, —á—Ç–æ **—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±—É–¥–µ—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–µ–Ω –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é** (–æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π).

–ù–æ –ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è (–∫–∞–∫ –±—É–¥—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–¥—É—Ç —Å—Ç—Ä–æ–≥–æ –ø–æ –æ—á–µ—Ä–µ–¥–∏) –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–∞—è. –ü–æ—ç—Ç–æ–º—É SQL —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–≤—ë–ª 4 —É—Ä–æ–≤–Ω—è –∏–∑–æ–ª—è—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±–∞–ª–∞–Ω—Å–∏—Ä—É—é—Ç –º–µ–∂–¥—É **–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é** –∏ **–Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å—é**.


***

## Read Uncommitted (–ß—Ç–µ–Ω–∏–µ –Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)


### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ **–µ—â—ë –Ω–µ –±—ã–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã (COMMIT)** –¥—Ä—É–≥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π.
* –¢–æ –µ—Å—Ç—å –º–æ–∂–Ω–æ "—É–≤–∏–¥–µ—Ç—å" –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–æ–º –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω—ã (`ROLLBACK`).


### –ü—Ä–æ–±–ª–µ–º—ã

* **Dirty Read (–≥—Ä—è–∑–Ω–æ–µ —á—Ç–µ–Ω–∏–µ)** ‚Äî —á–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞.
* –í–æ–∑–º–æ–∂–Ω—ã –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (non-repeatable read, phantom read).

üëâ –ü—Ä–∏–º–µ—Ä:

1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A: `UPDATE account SET balance = balance - 100 WHERE id = 1;` (–±–µ–∑ –∫–æ–º–º–∏—Ç–∞).
2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è B: –¥–µ–ª–∞–µ—Ç `SELECT balance FROM account WHERE id = 1;` –∏ –≤–∏–¥–∏—Ç —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å.
3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A –¥–µ–ª–∞–µ—Ç `ROLLBACK`. –ë–∞–ª–∞–Ω—Å –≤–µ—Ä–Ω—É–ª—Å—è, –∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è B –≤–∏–¥–µ–ª–∞ "–Ω–µ–ø—Ä–∞–≤–¥—É".


***

## Read Committed (–ß—Ç–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)


### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ **–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã** –¥—Ä—É–≥–∏–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
* –ö–∞–∂–¥–æ–µ –Ω–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –ë–î.


### –ü—Ä–æ–±–ª–µ–º—ã

* **Non-repeatable Read (–Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è —á—Ç–µ–Ω–∏–µ)** ‚Äî –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Å—Ç—Ä–æ–∫–∞ —á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –¥—Ä—É–≥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–¥–µ–ª–∞–ª–∞ `UPDATE` –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
* –í–æ–∑–º–æ–∂–Ω—ã —Ñ–∞–Ω—Ç–æ–º–Ω—ã–µ —á—Ç–µ–Ω–∏—è.

üëâ –ü—Ä–∏–º–µ—Ä:

1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A: `SELECT balance FROM account WHERE id = 1;` ‚Üí 1000.
2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è B: `UPDATE account SET balance = 2000 WHERE id = 1; COMMIT;`.
3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A —Å–Ω–æ–≤–∞ –¥–µ–ª–∞–µ—Ç `SELECT balance FROM account WHERE id = 1;` ‚Üí —É–∂–µ 2000.
   üìå –û–¥–Ω–æ –∏ —Ç–æ –∂–µ SELECT –≤–µ—Ä–Ω—É–ª —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.


***

## Repeatable Read (–ü–æ–≤—Ç–æ—Ä—è–µ–º–æ–µ —á—Ç–µ–Ω–∏–µ)


### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

* –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–∞ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ **–Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è –¥–æ –∫–æ–Ω—Ü–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –µ—ë –º–µ–Ω—è—é—Ç –∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç.
* –ù–æ! –ú–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–µ —É—Å–ª–æ–≤–∏—é –≤—ã–±–æ—Ä–∫–∏.


### –ü—Ä–æ–±–ª–µ–º—ã

* **Phantom Read (—Ñ–∞–Ω—Ç–æ–º–Ω—ã–µ —á—Ç–µ–Ω–∏—è)** ‚Äî –µ—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–µ–ª–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É –ø–æ —É—Å–ª–æ–≤–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≤—Å–µ —Å—á–µ—Ç–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º > 1000"), —Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

üëâ –ü—Ä–∏–º–µ—Ä:

1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A: `SELECT * FROM accounts WHERE balance > 1000;` ‚Üí 2 —Å—Ç—Ä–æ–∫–∏.
2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è B: `INSERT INTO accounts VALUES (id=3, balance=1500); COMMIT;`
3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A —Å–Ω–æ–≤–∞ –¥–µ–ª–∞–µ—Ç `SELECT ... WHERE balance > 1000;` ‚Üí —Ç–µ–ø–µ—Ä—å 3 —Å—Ç—Ä–æ–∫–∏.
   üìå "–§–∞–Ω—Ç–æ–º–Ω–∞—è" —Å—Ç—Ä–æ–∫–∞ –ø–æ—è–≤–∏–ª–∞—Å—å.


***

## Serializable (–°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º—ã–π)


### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è.
* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–∞–∫, **–∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω–∏ –∏–¥—É—Ç —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π**.
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ MVCC (–º–Ω–æ–≥–æ–≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å) —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.


### –ü—Ä–æ–±–ª–µ–º—ã

* –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º "–≥—Ä—è–∑–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è", "–Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è —á—Ç–µ–Ω–∏—è" –∏–ª–∏ "—Ñ–∞–Ω—Ç–æ–º–Ω—ã—Ö —á—Ç–µ–Ω–∏–π".
* –ù–æ —Å–∏–ª—å–Ω–æ –ø–∞–¥–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–≥—É—Ç –∂–¥–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ.

üëâ –ü—Ä–∏–º–µ—Ä:

1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A: `SELECT SUM(balance) FROM accounts;`
2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è B: —Ö–æ—á–µ—Ç `INSERT new account` ‚Üí –Ω–æ –¥–æ–ª–∂–Ω–∞ –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è A –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.


***

## –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –£—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏ | –ì—Ä—è–∑–Ω–æ–µ —á—Ç–µ–Ω–∏–µ | –ù–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è —á—Ç–µ–Ω–∏–µ | –§–∞–Ω—Ç–æ–º–Ω—ã–µ —á—Ç–µ–Ω–∏—è |
| ---------------- | -------------- | ---------------------- | ---------------- |
| Read Uncommitted | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ     | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ             | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ       |
| Read Committed   | ‚ùå –Ω–µ—Ç          | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ             | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ       |
| Repeatable Read  | ‚ùå –Ω–µ—Ç          | ‚ùå –Ω–µ—Ç                  | ‚úÖ –≤–æ–∑–º–æ–∂–Ω–æ       |
| Serializable     | ‚ùå –Ω–µ—Ç          | ‚ùå –Ω–µ—Ç                  | ‚ùå –Ω–µ—Ç            |


***

## –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏

* **Read Uncommitted** ‚Üí —Ä–µ–¥–∫–æ, –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –≥–¥–µ "–ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –¥–æ–ø—É—Å—Ç–∏–º–∞".
* **Read Committed** ‚Üí –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ PostgreSQL, Oracle (–±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å).
* **Repeatable Read** ‚Üí –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ MySQL/InnoDB. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
* **Serializable** ‚Üí –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Å—Ç–æ–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å (—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∞—É–¥–∏—Ç).

