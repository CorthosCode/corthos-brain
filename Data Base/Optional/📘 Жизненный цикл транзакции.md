# üìò –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è** ‚Äî —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –≤ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ª–∏–±–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é**, –ª–∏–±–æ **–Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤–æ–≤—Å–µ** (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å).

–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤, –∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –°–£–ë–î –≤–µ–¥—ë—Ç —Å–µ–±—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É.





***

## Active (–ê–∫—Ç–∏–≤–Ω–∞—è)

* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è:
  * –Ø–≤–Ω–æ: `BEGIN;` –∏–ª–∏ `START TRANSACTION;`
  * –ù–µ—è–≤–Ω–æ: –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∂–∏–º–∞ autocommit).
* –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (`INSERT`, `UPDATE`, `DELETE`, `SELECT ‚Ä¶ FOR UPDATE` –∏ —Ç. –¥.).
* –ü–æ–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞, –µ—ë –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã **—Ç–æ–ª—å–∫–æ —Å–∞–º–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** (–∏–∑-–∑–∞ –∏–∑–æ–ª—è—Ü–∏–∏).





***

## Partially Committed (–ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)

* –í—Å–µ SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.
* –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `COMMIT`.
* –ù–æ –ø–æ–∫–∞ –µ—â—ë –¥–∞–Ω–Ω—ã–µ **–Ω–µ –∑–∞–ø–∏—Å–∞–Ω—ã –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ –¥–∏—Å–∫** ‚Äî –æ–Ω–∏ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –±—É—Ñ–µ—Ä–∞—Ö.





***

## Committed (–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è / –£—Å–ø–µ—à–Ω–∞—è)

* –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ `COMMIT` –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è:
  * **–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏** (persisted);
  * **–≤–∏–¥–∏–º—ã–º–∏** –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
* –í PostgreSQL ‚Äî —ç—Ç–æ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –∑–∞–ø–∏—Å—å –ø–æ–ø–∞–ª–∞ –≤ WAL (–∂—É—Ä–Ω–∞–ª –ø—Ä–µ–¥–∑–∞–ø–∏—Å–∏), —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ–µ.





***

## Failed (–ù–µ—É—Å–ø–µ—à–Ω–∞—è / –û—à–∏–±–æ—á–Ω–∞—è)

* –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ (`UNIQUE violation`, `division by zero`, `deadlock detected`), —Ç–æ:
  * –í PostgreSQL —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ **–æ—à–∏–±–æ—á–Ω–∞—è**.
  * –û–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã, –∫—Ä–æ–º–µ `ROLLBACK`.
* –í–∞–∂–Ω–æ: PostgreSQL –æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∏–π ‚Äî –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ *–Ω–µ–ª—å–∑—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é*, –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å.





***

## Aborted (–û—Ç–º–µ–Ω—ë–Ω–Ω–∞—è)

* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—ã–ª–∞ **–æ—Ç–º–µ–Ω–µ–Ω–∞**:
  * –Ø–≤–Ω–æ: `ROLLBACK;`
  * –ù–µ—è–≤–Ω–æ: –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –∏–ª–∏ —Å–±–æ—è.
* –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏, **–æ—Ç–º–µ–Ω—è—é—Ç—Å—è**.
* –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.





***

## –ì—Ä–∞—Ñ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (ANSI/ISO SQL)

```sql
          +--------------------+
          |    Active          |
          +--------------------+
            |                \
            |                 \
            v                  v
  +----------------+   +-----------------+
  | Partially      |   | Failed          |
  | Committed      |   +-----------------+
  +----------------+           |
            |                  |
            v                  v
   +----------------+   +-----------------+
   | Committed      |   | Aborted         |
   +----------------+   +-----------------+
```



