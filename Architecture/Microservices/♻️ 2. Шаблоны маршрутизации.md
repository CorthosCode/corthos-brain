
Шаблоны маршрутизации микросервисов определяют, как клиентское приложение обнаруживает местонахождение службы и отправляет ей запросы.
В облачном приложении могут быть запущены сотни экземпляров микросервиса.
Чтобы обеспечить соблюдение политик безопасности и выбора контента, необходимо абстрагировать физический IP-адрес служб и организовать единую точку входа.

Решить эту задачу помогают следующие шаблоны:
- Обнаружение служб
- Маршрутизация служб

На рисунке ниже показано, что обнаружение и маршрутизация служб выполняются в четко определенной последовательности (сначала выполняется маршрутизация, а затем обнаружение службы).

Однако эти две модели не зависят друг от друга.

Например, можно реализовать обнаружение служб без маршрутизации и точно так же можно реализовать маршрутизацию служб без обнаружения (хотя реализация при этом усложнится).

![Обнаружение и маршрутизация](assets/Microservices/marshrut_template.png)


---

## Обнаружение служб

С помощью функции обнаружения служб и ее ключевого компонента – реестра служб – можно сделать микросервис доступным для обнаружения клиентскими приложениями без жесткого определения местоположения службы в их коде.

Помните, что механизм обнаружения служб – это внутренняя служба, а не служба, ориентированная на клиентов.

Часто используется Netflix Eureka Service Discovery, но есть и другие реестры служб, такие как etcd, Consul и Apache Zookeeper. Кроме того, в некоторых системах вообще нет явного реестра служб. Вместо него они используют коммуникационную инфраструктуру, известную как сервисная сетка (**service mesh**).


---

## Маршрутизация служб

помощью API-шлюза в приложениях на основе микросервисов можно организовать единую точку входа для всех служб и обеспечить единообразное применение политик безопасности и правил маршрутизации к нескольким службам и их экземплярам.

