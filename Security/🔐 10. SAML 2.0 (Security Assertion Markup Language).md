
**SAML 2.0 (Security Assertion Markup Language)** ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ XML, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—è–≤–∏–ª—Å—è —Ä–∞–Ω—å—à–µ OAuth2 –∏ OpenID Connect. –û–Ω –¥–æ —Å–∏—Ö –ø–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, SSO –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è—Ö —Å AD / LDAP.

SAML —Ä–µ—à–∞–µ—Ç —Ç—É –∂–µ –∑–∞–¥–∞—á—É, —á—Ç–æ –∏ OIDC ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç **–≤—Ö–æ–¥–∏—Ç—å –≤ —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)** —Å –æ–¥–Ω–æ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é (**SSO ‚Äî Single Sign-On**).

–ù–∞–ø—Ä–∏–º–µ—Ä:

> –¢—ã –≤—Ö–æ–¥–∏—à—å –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª, –∏ –ø–æ—Ç–æ–º –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞ –∑–∞—Ö–æ–¥–∏—à—å –≤ Jira, Confluence, Outlook Web –∏ —Ç.–¥.


***

## üèóÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                   | –†–æ–ª—å                                                                                       | –ê–Ω–∞–ª–æ–≥ –≤ OAuth2          |
| --------------------------- | ------------------------------------------------------------------------------------------ | ------------------------ |
| **Identity Provider (IdP)** | –£–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Keycloak, Okta, Azure AD)                                | Authorization Server     |
| **Service Provider (SP)**   | –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—á–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–≤–æ–π Spring Boot —Å–∞–π—Ç) | Client / Resource Server |
| **User Agent**              | –ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                                                                       | ‚Äî                        |


***

## üîÅ –ü–æ—Ç–æ–∫ SAML-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π—Ç (SP).
2. SP –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –Ω–∞ IdP.
3. IdP –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Å–≤–æ—é —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞** (–∞ –Ω–µ —Ç–≤–æ—é!).
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ IdP —Å–æ–∑–¥–∞—ë—Ç **SAML Assertion** (XML-–¥–æ–∫—É–º–µ–Ω—Ç, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é).
5. IdP –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ SP —Å —ç—Ç–∏–º Assertion.
6. SP –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (email, name, roles –∏ —Ç.–¥.).
7. SP —Å–æ–∑–¥–∞—ë—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é –∏ –≤–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.


***

## üìú –ü—Ä–∏–º–µ—Ä SAML Assertion (–≤ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–º –≤–∏–¥–µ)

```xml
<saml:Assertion>
  <saml:Issuer>https://idp.example.com</saml:Issuer>
  <saml:Subject>
    <saml:NameID>nikita@example.com</saml:NameID>
  </saml:Subject>
  <saml:AttributeStatement>
    <saml:Attribute Name="givenName">Nikita</saml:Attribute>
    <saml:Attribute Name="surname">Kotov</saml:Attribute>
    <saml:Attribute Name="role">admin</saml:Attribute>
  </saml:AttributeStatement>
  <saml:AuthnStatement AuthnInstant="2025-10-08T20:10:00Z" />
</saml:Assertion>
```


***

## ‚öôÔ∏è –û—Ç–ª–∏—á–∏—è –æ—Ç OAuth2 / OIDC

| –ö—Ä–∏—Ç–µ—Ä–∏–π              | **SAML 2.0**                        | **OAuth 2.0 / OIDC**            |
| --------------------- | ----------------------------------- | ------------------------------- |
| –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π      | XML                                 | JSON / JWT                      |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è      | Enterprise SSO                      | –í–µ–±, –º–æ–±–∏–ª–∫–∏, API               |
| –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç             | Redirect + POST (Browser)           | HTTP + REST                     |
| –ü–æ–¥–ø–∏—Å–∏               | XML Signature                       | JWT –ø–æ–¥–ø–∏—Å–∏ (JWS)               |
| –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã | AD FS, Okta, Keycloak, PingIdentity | Google, GitHub, Keycloak, Auth0 |
| –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω        | Assertion (XML)                     | Access/ID Token (JWT)           |


***

## üí° –ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—é—Ç SAML

‚úÖ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ä–µ–¥–∞ (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Active Directory / LDAP)

‚úÖ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Ä—Ç–∞–ª—ã, –≥–¥–µ —É–∂–µ –µ—Å—Ç—å IdP —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SAML

‚úÖ –°—Ç—Ä–æ–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≥–¥–µ XML-–ø–æ–¥–ø–∏—Å–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã

‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è REST API –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ ‚Äî —Å–ª–∏—à–∫–æ–º "—Ç—è–∂—ë–ª—ã–π" –∏ –±—Ä–∞—É–∑–µ—Ä–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π.


***

## üß∞ –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ SAML –≤ Spring Boot

Spring Security —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å SAML —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å:

```groovy
implementation 'org.springframework.security:spring-security-saml2-service-provider'
```

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```java
@Bean
SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
        .saml2Login(Customizer.withDefaults()) // üîí –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ SAML
        .authorizeHttpRequests(auth -> auth
            .anyRequest().authenticated()
        );
    return http.build();
}
```

Spring —Å–∞–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
* Redirect –Ω–∞ IdP,
* –í–∞–ª–∏–¥–∞—Ü–∏—é SAML –æ—Ç–≤–µ—Ç–∞,
* –°–æ–∑–¥–∞–Ω–∏–µ `Authentication` –∏–∑ SAML Assertion.

