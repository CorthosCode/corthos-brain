
**JWT** ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –ø–æ–¥–ø–∏—Å–∞–Ω —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é (–∏–Ω–æ–≥–¥–∞ –µ—â—ë –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω).

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **stateless-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** ‚Äî —Å–µ—Ä–≤–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏—é, –≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Ç–æ–∫–µ–Ω–µ.


***

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–∫–µ–Ω–∞

JWT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **—Ç—Ä—ë—Ö —á–∞—Å—Ç–µ–π**, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞–º–∏:

```java
xxxxx.yyyyy.zzzzz
```

| –ß–∞—Å—Ç—å | –ù–∞–∑–≤–∞–Ω–∏–µ      | –§–æ—Ä–º–∞—Ç                                 | –ü—Ä–∏–º–µ—Ä                                            |
| ----- | ------------- | -------------------------------------- | ------------------------------------------------- |
| 1Ô∏è‚É£   | **Header**    | JSON, Base64                           | `{"alg":"HS256","typ":"JWT"}`                     |
| 2Ô∏è‚É£   | **Payload**   | JSON, Base64                           | `{"sub":"user1","role":"ADMIN","exp":1735689600}` |
| 3Ô∏è‚É£   | **Signature** | HMAC-SHA256(header + payload + secret) | `f7c2d5...`                                       |

üìå –í—Å—ë –≤–º–µ—Å—Ç–µ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```java
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJBRE1JTiIsImV4cCI6MTczNTY4OTYwMH0.r_i8RvDPiXgcYwlGgPZ6LsfvZwovKMkyq5o60CPqB9E
```


***

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è**
   ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –Ω–∞ `/login`.
2. **–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç**
   ‚Üí —Å–æ–∑–¥–∞—ë—Ç JWT —Å –¥–∞–Ω–Ω—ã–º–∏ (id, —Ä–æ–ª–∏, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è)
   ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –µ–≥–æ —Å–µ–∫—Ä–µ—Ç–æ–º (`HS256`)
   ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –∫–ª–∏–µ–Ω—Ç—É.
3. **–ö–ª–∏–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω**
   ‚Üí –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `localStorage` –∏–ª–∏ `Authorization` header.
4. **–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ**
   ‚Üí –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω:

```java
Authorization: Bearer <jwt_token>
```

1. **–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è**
   ‚Üí –µ—Å–ª–∏ –≤—Å—ë –≤–∞–ª–∏–¥–Ω–æ, –ø—É—Å–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–Ω–∞—á–µ `401 Unauthorized`.


***

## üß∞ –ü—Ä–∏–º–µ—Ä –Ω–∞ Java (–±–µ–∑ Spring)

–ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É **jjwt** (io.jsonwebtoken):

```xml
<dependency>
  <groupId>io.jsonwebtoken</groupId>
  <artifactId>jjwt-api</artifactId>
  <version>0.11.5</version>
</dependency>
<dependency>
  <groupId>io.jsonwebtoken</groupId>
  <artifactId>jjwt-impl</artifactId>
  <version>0.11.5</version>
  <scope>runtime</scope>
</dependency>
<dependency>
  <groupId>io.jsonwebtoken</groupId>
  <artifactId>jjwt-jackson</artifactId>
  <version>0.11.5</version>
  <scope>runtime</scope>
</dependency>
```

–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:

```java
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.security.Keys;
import java.security.Key;
import java.util.Date;

public class JwtExample {
    public static void main(String[] args) {
        Key key = Keys.secretKeyFor(SignatureAlgorithm.HS256);

        String jwt = Jwts.builder()
                .setSubject("admin")
                .claim("role", "ADMIN")
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + 3600000)) // 1 —á–∞—Å
                .signWith(key)
                .compact();

        System.out.println("JWT: " + jwt);
    }
}
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞:

```java
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.security.Keys;
import java.security.Key;

public class JwtVerify {
    public static void main(String[] args) {
        String token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";
        Key key = Keys.hmacShaKeyFor("mysecretmysecretmysecretmysecret".getBytes());

        var claims = Jwts.parserBuilder()
                .setSigningKey(key)
                .build()
                .parseClaimsJws(token)
                .getBody();

        System.out.println("User: " + claims.getSubject());
        System.out.println("Role: " + claims.get("role"));
    }
}
```


***

## üß© JWT –≤ Spring Boot

JWT –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≤–º–µ—Å—Ç–æ session auth**, —Ç–æ –µ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è *stateless*.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞)**

1Ô∏è‚É£ **–§–∏–ª—å—Ç—Ä** –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞:

```java
@Component
public class JwtAuthFilter extends OncePerRequestFilter {

    private final String SECRET = "mysecretmysecretmysecretmysecret";

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {

        String authHeader = request.getHeader("Authorization");

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            String token = authHeader.substring(7);

            try {
                var claims = Jwts.parserBuilder()
                        .setSigningKey(SECRET.getBytes())
                        .build()
                        .parseClaimsJws(token)
                        .getBody();

                String username = claims.getSubject();

                UsernamePasswordAuthenticationToken authentication =
                        new UsernamePasswordAuthenticationToken(username, null, List.of());
                SecurityContextHolder.getContext().setAuthentication(authentication);

            } catch (Exception e) {
                response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
                return;
            }
        }

        filterChain.doFilter(request, response);
    }
}
```

2Ô∏è‚É£ **–ö–æ–Ω—Ñ–∏–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

```java
@Configuration
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http, JwtAuthFilter jwtFilter) throws Exception {
        http
            .csrf().disable()
            .sessionManagement(s -> s.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/login").permitAll()
                .anyRequest().authenticated()
            )
            .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class);

        return http.build();
    }
}
```

3Ô∏è‚É£ **–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –≤—ã–¥–∞—á–∏ —Ç–æ–∫–µ–Ω–∞**

```java
@RestController
public class AuthController {

    @PostMapping("/login")
    public Map<String, String> login(@RequestBody Map<String, String> body) {
        String username = body.get("username");
        String password = body.get("password");

        if ("admin".equals(username) && "1234".equals(password)) {
            String token = Jwts.builder()
                    .setSubject(username)
                    .claim("role", "ADMIN")
                    .setIssuedAt(new Date())
                    .setExpiration(new Date(System.currentTimeMillis() + 3600000))
                    .signWith(Keys.hmacShaKeyFor("mysecretmysecretmysecretmysecret".getBytes()))
                    .compact();

            return Map.of("token", token);
        }

        throw new ResponseStatusException(HttpStatus.UNAUTHORIZED);
    }
}
```


***

## ‚öñÔ∏è JWT vs Session Auth

| –ö—Ä–∏—Ç–µ—Ä–∏–π             | Session Auth             | JWT Auth                    |
| -------------------- | ------------------------ | --------------------------- |
| –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è   | –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏–∏     | Stateless                   |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ      | –°–ª–æ–∂–Ω–æ                   | –õ–µ–≥–∫–æ                       |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞  | Cookie –∑–∞—â–∏—â–µ–Ω—ã HttpOnly | –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤—Ä—É—á–Ω—É—é |
| –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è        | –ü–æ–∫–∞ —Å–µ—Å—Å–∏—è –∞–∫—Ç–∏–≤–Ω–∞      | –í—Å—Ç—Ä–æ–µ–Ω `exp`               |
| –£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è SPA/API | –ù–µ—É–¥–æ–±–Ω–æ                 | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ                  |

