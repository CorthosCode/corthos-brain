
**OAuth 2.0** â€” ÑÑ‚Ð¾ **Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸**, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¾Ð´Ð½Ð¾Ð¼Ñƒ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸ÑŽ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ *Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿* Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² Ð´Ñ€ÑƒÐ³Ð¾Ð¼ ÑÐµÑ€Ð²Ð¸ÑÐµ **Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð»Ð¾Ð³Ð¸Ð½Ð° Ð¸ Ð¿Ð°Ñ€Ð¾Ð»Ñ**.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
Ð¢Ñ‹ Ð»Ð¾Ð³Ð¸Ð½Ð¸ÑˆÑŒÑÑ Ð² Spotify Ñ‡ÐµÑ€ÐµÐ· Google â†’ Spotify Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ñ‚Ð²Ð¾ÐµÐ¼Ñƒ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŽ Ð² Google, Ð½Ð¾ **Ð½Ðµ Ð·Ð½Ð°ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð°Ñ€Ð¾Ð»Ñ** â€” Ð²ÑÑ‘ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ñ‡ÐµÑ€ÐµÐ· Ñ‚Ð¾ÐºÐµÐ½.


***

## ðŸ§  ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð´ÐµÑ

OAuth 2.0 ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑÑ Ð²Ð¾ÐºÑ€ÑƒÐ³ **Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²** (Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ â€” `access_token` Ð¸ `refresh_token`), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð²Ñ‹Ð´Ð°ÐµÑ‚ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ **Authorization Server**.


***

## âš™ï¸ Ð“Ð»Ð°Ð²Ð½Ñ‹Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸

| Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸Ðº                 | Ð Ð¾Ð»ÑŒ                                                             |
| ------------------------ | ---------------------------------------------------------------- |
| **Resource Owner**       | Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ (Ð²Ð»Ð°Ð´ÐµÐ»ÐµÑ† Ð´Ð°Ð½Ð½Ñ‹Ñ…)                                   |
| **Client**               | Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ñ…Ð¾Ñ‡ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Spotify)    |
| **Authorization Server** | ÑÐµÑ€Ð²ÐµÑ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð²Ñ‹Ð´Ð°Ñ‘Ñ‚ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ (Google, Keycloak, GitHub Ð¸ Ñ‚.Ð´.)  |
| **Resource Server**      | API, Ð³Ð´Ðµ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð·Ð°Ñ‰Ð¸Ñ‰Ñ‘Ð½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Google Drive API) |


***

## ðŸ” ÐŸÐ¾Ñ‚Ð¾ÐºÐ¸ (flows)

OAuth 2.0 Ð¸Ð¼ÐµÐµÑ‚ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‚Ð¸Ð¿Ð¾Ð² Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð², Ð½Ð¾ Ð²Ð°Ð¶Ð½Ñ‹ 3:

| ÐŸÐ¾Ñ‚Ð¾Ðº                           | Ð“Ð´Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ                  | ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸                                                            |
| ------------------------------- | -------------------------------- | ---------------------------------------------------------------------- |
| **Authorization Code Flow**     | Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ                   | Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ ÐºÐ¾Ð´                               |
| **Client Credentials Flow**     | ÑÐµÑ€Ð²ÐµÑ€-ÑÐµÑ€Ð²ÐµÑ€ (Ð±ÐµÐ· Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ) | Ñ‚Ð¾ÐºÐµÐ½ Ð²Ñ‹Ð´Ð°ÐµÑ‚ÑÑ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸ÑŽ                                              |
| **Password Flow***(ÑƒÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ð¹)* | Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ðµ/CLI-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ         | Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð²Ð²Ð¾Ð´Ð¸Ñ‚ Ð»Ð¾Ð³Ð¸Ð½/Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð¿Ñ€ÑÐ¼Ð¾ Ð² Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ (Ð½Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ) |


***

## ðŸ§­ ÐŸÑ€Ð¸Ð¼ÐµÑ€: Authorization Code Flow

1. ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñƒ **Authorization Server**:

```java
GET /authorize?client_id=abc123&redirect_uri=https://app.com/callback&response_type=code
```

1. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð»Ð¾Ð³Ð¸Ð½Ð¸Ñ‚ÑÑ Ð¸ ÑÐ¾Ð³Ð»Ð°ÑˆÐ°ÐµÑ‚ÑÑ Ð²Ñ‹Ð´Ð°Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿.
2. Ð¡ÐµÑ€Ð²ÐµÑ€ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾:

```java
https://app.com/callback?code=XYZ
```

1. ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ð±Ð¼ÐµÐ½Ð¸Ð²Ð°ÐµÑ‚ `code` Ð½Ð° `access_token`:

```java
POST /token
grant_type=authorization_code
code=XYZ
client_id=abc123
client_secret=secret
```

1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚:

```java
{
  "access_token": "eyJhbGciOiJIUzI1...",
  "expires_in": 3600,
  "refresh_token": "9sdf98234",
  "token_type": "Bearer"
}
```

1. Ð¡ ÑÑ‚Ð¸Ð¼ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒÑÑ Ðº API:

```java
GET /userinfo
Authorization: Bearer eyJhbGciOiJIUzI1...
```


***

## ðŸ§° ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ Ð² Spring Boot

Spring Security ÑƒÐ¼ÐµÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ñ OAuth2 â€œÐ¸Ð· ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ¸â€ (Google, GitHub, Keycloak Ð¸ Ñ‚.Ð´.):

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(auth -> auth
                .anyRequest().authenticated()
            )
            .oauth2Login(); // <-- Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ OAuth2 flow
        return http.build();
    }
}
```

`application.yml`:

```yaml
spring:
  security:
    oauth2:
      client:
        registration:
          github:
            client-id: your_client_id
            client-secret: your_secret
            scope: read:user
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€Ð¸ Ð²Ñ…Ð¾Ð´Ðµ Ð½Ð° `/login` Spring:

* Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ Ð½Ð° GitHub,
* Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ `code`,
* Ð¾Ð±Ð¼ÐµÐ½ÑÐµÑ‚ ÐµÐ³Ð¾ Ð½Ð° `access_token`,
* ÑÐ¾Ð·Ð´Ð°ÑÑ‚ ÑÐµÑÑÐ¸ÑŽ Ð² `SecurityContext`.


***

## ðŸ”‘ ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²

| Ð¢Ð¸Ð¿ Ñ‚Ð¾ÐºÐµÐ½Ð°        | Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚                                            | Ð–Ð¸Ð·Ð½ÑŒ                      |
| ----------------- | ----------------------------------------------------- | -------------------------- |
| **Access Token**  | Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº API                        | ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ (5â€“60 Ð¼Ð¸Ð½)        |
| **Refresh Token** | Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ access-Ñ‚Ð¾ÐºÐµÐ½ Ð±ÐµÐ· Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð»Ð¾Ð³Ð¸Ð½Ð°          | Ð´Ð¾Ð»Ð³Ð¾Ð¶Ð¸Ð²ÑƒÑ‰Ð¸Ð¹ (Ð´Ð½Ð¸, Ð½ÐµÐ´ÐµÐ»Ð¸) |
| **ID Token**      | (Ð² OpenID Connect) ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¸Ð½Ñ„Ð¾ Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ðµ (JWT) | ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹                   |


***

## ðŸ§± Ð“Ð´Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ

* **SSO** (Single Sign-On)
* **API Gateway Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ**
* **ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ðµ/SPA-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ**
* **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼Ð¸ (Google, GitHub, Discord)**
* **ÐœÐ¸ÐºÑ€Ð¾ÑÐµÑ€Ð²Ð¸ÑÑ‹** â€” Ñ‡ÐµÑ€ÐµÐ· Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ð¼ÐµÐ¶Ð´Ñƒ ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼Ð¸

